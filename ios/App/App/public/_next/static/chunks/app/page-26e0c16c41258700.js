(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{24:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l});var a=n(5155),r=n(2115),s=n(6104);function i(e){if("undefined"==typeof document)return console.warn("포그라운드 알림은 메인 스레드에서만 생성할 수 있습니다."),!1;try{if("Notification"in window&&"granted"===Notification.permission)return new Notification(e.title,{body:e.body,icon:e.icon,tag:e.tag,data:e.data}),!0;return!1}catch(e){return console.warn("포그라운드 알림 생성 실패:",e),!1}}var o=n(9509);function l(){let[e,t]=(0,r.useState)("디바이스 정보를 불러오는 중..."),[n,l]=(0,r.useState)("설치 상태를 확인하는 중..."),[c,d]=(0,r.useState)(null),[g,m]=(0,r.useState)(""),[u,x]=(0,r.useState)(!1),[h,p]=(0,r.useState)(""),[f,b]=(0,r.useState)(!1),[y,w]=(0,r.useState)(!1),[v,k]=(0,r.useState)(null),[j,N]=(0,r.useState)("알림 권한 확인 중..."),[S,D]=(0,r.useState)(!1),[C,A]=(0,r.useState)("확인 중..."),I=o.env.BUILD_TIME||"2024-01-01T00:00:00.000Z",P=o.env.BUILD_VERSION||"v1.0.0";(0,r.useEffect)(()=>{b(!0);let e=()=>{p(new Date().toLocaleString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:"Asia/Seoul"}))};e();let n=setInterval(e,1e3),a=null;"Notification"in window&&(A(Notification.permission),a=setInterval(()=>{let e=Notification.permission;A(e),"denied"===e&&"알림 권한 거부됨"!==j?(N("알림 권한 거부됨"),k(null),localStorage.removeItem("fcm-token")):"granted"!==e||v||"FCM 토큰 생성 실패"===j||console.log("권한이 허용되었습니다. FCM 토큰을 다시 요청합니다.")},2e3));let r=e=>{"Escape"===e.key&&(u&&x(!1),y&&w(!1))};document.addEventListener("keydown",r),t(navigator.userAgent),window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone?l("설치된 앱으로 실행 중"):l("브라우저에서 실행 중");let o=()=>{let e={isHttps:"https:"===window.location.protocol||"localhost"===window.location.hostname,hasServiceWorker:"serviceWorker"in navigator,hasManifest:!!document.querySelector('link[rel="manifest"]'),isChrome:/Chrome/.test(navigator.userAgent)&&!/Edge/.test(navigator.userAgent),isMobile:/Android|iPhone|iPad|iPod/i.test(navigator.userAgent),beforeInstallPromptFired:!!c,isStandalone:window.matchMedia("(display-mode: standalone)").matches,hasMinimalUI:window.matchMedia("(display-mode: minimal-ui)").matches,isIOS:/iPhone|iPad|iPod/i.test(navigator.userAgent),isSafari:/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)};m("PWA 설치 조건 확인:\n• HTTPS/localhost: ".concat(e.isHttps?"✓":"✗","\n• 서비스 워커: ").concat(e.hasServiceWorker?"✓":"✗","\n• 웹 매니페스트: ").concat(e.hasManifest?"✓":"✗","\n• Chrome 브라우저: ").concat(e.isChrome?"✓":"✗","\n• iOS Safari: ").concat(e.isIOS&&e.isSafari?"✓":"✗","\n• 모바일 기기: ").concat(e.isMobile?"✓":"✗","\n• beforeinstallprompt 이벤트: ").concat(e.beforeInstallPromptFired?"✓":"✗","\n• 이미 설치됨: ").concat(e.isStandalone?"✓":"✗","\n• URL: ").concat(window.location.href,"\n\n추가 정보:\n• User Agent: ").concat(navigator.userAgent,"\n• 화면 모드: ").concat(window.matchMedia("(display-mode: standalone)").matches?"standalone":"browser")),console.log("PWA 설치 조건:",e)};o(),(async()=>{try{if("Notification"in window){let e=Notification.permission;if(console.log("초기 알림 권한 상태:",e),A(e),"granted"===e){N("FCM 토큰 확인 중...");let e=await (0,s.mT)();e.success&&e.token?(k(e.token),N("알림 권한 허용됨"),console.log("FCM Token 저장됨:",e.token),localStorage.setItem("fcm-token",e.token)):(console.warn("FCM 토큰 생성 실패:",e.error),N("FCM 토큰 생성 실패"),A(Notification.permission))}else"denied"===e?N("알림 권한 거부됨"):N("알림 권한 요청 필요")}else N("알림 지원되지 않음");(0,s.d7)().then(e=>{if(console.log("포그라운드 메시지 수신:",e),e&&"object"==typeof e){var t,n;i({title:(null==(t=e.notification)?void 0:t.title)||"새 알림",body:null==(n=e.notification)?void 0:n.body,icon:"/icons/icon-192x192.svg"})}}).catch(e=>console.log("포그라운드 메시지 리스너 오류:",e))}catch(e){console.error("FCM 초기화 오류:",e),N("FCM 초기화 실패")}})();let g=e=>{console.log("beforeinstallprompt 이벤트 발생!",e),e.preventDefault(),d(e),l("설치 가능 (프롬프트 준비됨)"),x(!1),o()};return window.addEventListener("beforeinstallprompt",g),()=>{clearInterval(n),a&&clearInterval(a),document.removeEventListener("keydown",r),window.removeEventListener("beforeinstallprompt",g)}},[c,u,y,v,j]);let E=async()=>{if(!c){let e=/Chrome/.test(navigator.userAgent)&&!/Edge/.test(navigator.userAgent),t=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent),n=/iPhone|iPad|iPod/i.test(navigator.userAgent),a=/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent);n&&a?w(!0):e&&!t?alert('데스크톱 Chrome에서 PWA 설치하기:\n1. 주소창 오른쪽의 설치 아이콘(⊕)을 클릭하거나\n2. 메뉴(⋮) > 앱 설치 > "TWA Test App 설치"를 선택하세요.\n\n현재 beforeinstallprompt 이벤트가 발생하지 않았습니다.\n페이지를 새로고침하거나 잠시 후 다시 시도해보세요.'):t&&e?alert('모바일 Chrome에서 PWA 설치하기:\n1. 메뉴(⋮) > "홈 화면에 추가"를 선택하거나\n2. 하단에 나타나는 설치 배너를 사용하세요.\n\n현재 beforeinstallprompt 이벤트가 발생하지 않았습니다.'):n?w(!0):alert("PWA 설치를 위해 Chrome 브라우저 또는 iOS Safari를 사용해주세요.");return}try{c.prompt();let{outcome:e}=await c.userChoice;console.log("사용자 선택: ".concat(e)),d(null),x(!1)}catch(e){console.error("설치 프롬프트 오류:",e),alert("설치 중 오류가 발생했습니다: "+(e instanceof Error?e.message:String(e)))}},T=async()=>{D(!0),console.log("권한 요청 전 상태:",{notificationPermission:"Notification"in window?Notification.permission:"unknown",currentStatus:j,browserPermission:C});try{let e=await (0,s.mT)();console.log("권한 요청 결과:",e),e.success&&e.token?(k(e.token),N("알림 권한 허용됨"),A(e.permission||"granted"),localStorage.setItem("fcm-token",e.token),alert("알림 권한이 허용되었습니다!\nFCM 토큰: "+e.token.substring(0,50)+"...")):"denied"===e.permission?(N("알림 권한 거부됨"),A("denied"),alert("알림 권한이 거부되었습니다.")):"default"===e.permission?(N("알림 권한 요청 필요"),A("default"),alert("알림 권한 요청이 취소되었습니다.")):"granted"===e.permission?(N("FCM 토큰 생성 실패"),A("granted"),alert("알림 권한은 허용되었지만 FCM 토큰 생성에 실패했습니다.\n오류: "+e.error)):(N("알림 권한 요청 실패"),A("unknown"),alert("알림 권한 요청 중 오류가 발생했습니다.\n오류: "+e.error))}catch(e){console.error("알림 권한 요청 오류:",e),N("알림 권한 요청 실패"),alert("알림 권한 요청 중 오류가 발생했습니다.")}finally{D(!1)}},M=async()=>{if(!v)return void alert("FCM 토큰이 없습니다. 먼저 알림 권한을 허용해주세요.");D(!0),console.log("테스트 알림 발송 시작...");try{let e={token:v,title:"\uD83D\uDD14 TWA 테스트 알림",message:"테스트 알림입니다! 시간: ".concat(new Date().toLocaleTimeString("ko-KR")),data:{testData:"test-value",timestamp:Date.now().toString(),url:window.location.href}};console.log("발송할 알림 데이터:",e);let t=await fetch("/api/send-notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await t.json();console.log("알림 발송 응답:",n),n.success?(alert("✅ 테스트 알림이 성공적으로 발송되었습니다!\n\n\uD83D\uDCF1 알림이 표시되지 않는다면:\n1. 브라우저 알림 설정을 확인하세요\n2. 다른 탭에서 앱을 열어보세요\n3. 모바일에서는 백그라운드 상태로 전환해보세요"),i({title:"\uD83D\uDD14 TWA 테스트 알림",body:"포그라운드 테스트 알림입니다! 시간: ".concat(new Date().toLocaleTimeString("ko-KR")),icon:"/icons/icon-192x192.svg",tag:"test-notification"})):(console.error("알림 발송 실패:",n),alert("❌ 알림 발송 실패\n\n오류: ".concat(n.error,"\n상세: ").concat(n.details||"없음")))}catch(e){console.error("알림 발송 오류:",e),alert("❌ 알림 발송 중 오류가 발생했습니다.\n\n오류: ".concat(e instanceof Error?e.message:String(e)))}finally{D(!1)}},F=async()=>{let e=localStorage.getItem("fcm-token");if(!e)return void alert("저장된 FCM 토큰이 없습니다.");D(!0),console.log("전체 알림 발송 시작...");try{let a={tokens:[e],title:"\uD83D\uDCE2 전체 알림",message:"모든 사용자에게 보내는 알림입니다! ".concat(new Date().toLocaleTimeString("ko-KR")),data:{type:"broadcast",timestamp:Date.now().toString(),url:window.location.href}};console.log("발송할 전체 알림 데이터:",a);let r=await fetch("/api/send-notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),s=await r.json();if(console.log("전체 알림 발송 응답:",s),s.success){var t,n;alert("✅ 전체 알림이 성공적으로 발송되었습니다!\n\n발송 결과:\n- 성공: ".concat((null==(t=s.result)?void 0:t.successCount)||1,"개\n- 실패: ").concat((null==(n=s.result)?void 0:n.failureCount)||0,"개")),i({title:"\uD83D\uDCE2 전체 알림",body:"전체 사용자 알림입니다! 시간: ".concat(new Date().toLocaleTimeString("ko-KR")),icon:"/icons/icon-192x192.svg",tag:"broadcast-notification"})}else console.error("전체 알림 발송 실패:",s),alert("❌ 전체 알림 발송 실패\n\n오류: ".concat(s.error,"\n상세: ").concat(s.details||"없음"))}catch(e){console.error("전체 알림 발송 오류:",e),alert("❌ 전체 알림 발송 중 오류가 발생했습니다.\n\n오류: ".concat(e instanceof Error?e.message:String(e)))}finally{D(!1)}};return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen p-4 bg-gradient-to-b from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:[u&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4 animate-fadeIn",onClick:e=>{e.target===e.currentTarget&&x(!1)},children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-sm w-full p-6 transform transition-all animate-slideUp",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-4",children:(0,a.jsx)("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center animate-pulse",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-center mb-2 text-gray-800 dark:text-white",children:"앱 설치하기"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 text-center mb-6",children:"이 앱을 홈 화면에 설치하여 더 빠르고 편리하게 사용하세요!"}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:()=>x(!1),className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-white font-medium rounded-lg transition-colors",children:"나중에"}),(0,a.jsx)("button",{onClick:E,className:"flex-1 py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"설치하기"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-400 text-center mt-3",children:"ESC 키를 눌러 닫을 수 있습니다"})]})}),y&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4 animate-fadeIn",onClick:e=>{e.target===e.currentTarget&&w(!1)},children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-sm w-full p-6 transform transition-all animate-slideUp",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-4",children:(0,a.jsx)("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-2xl",children:"\uD83C\uDF4E"})})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-center mb-2 text-gray-800 dark:text-white",children:"iOS에서 앱 설치하기"}),(0,a.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)("span",{className:"text-lg",children:"\uD83D\uDCE4"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-800 dark:text-white",children:"1. 공유 버튼 탭"}),(0,a.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:"하단의 공유 버튼(\uD83D\uDCE4)을 탭하세요"})]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)("span",{className:"text-lg",children:"➕"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-800 dark:text-white",children:'2. "홈 화면에 추가" 선택'}),(0,a.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:'메뉴에서 "홈 화면에 추가"를 찾아 탭하세요'})]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)("span",{className:"text-lg",children:"✅"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-800 dark:text-white",children:'3. "추가" 버튼 탭'}),(0,a.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:'앱 이름을 확인하고 "추가"를 탭하세요'})]})]})]}),(0,a.jsx)("button",{onClick:()=>w(!1),className:"w-full py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"확인했습니다"}),(0,a.jsx)("p",{className:"text-xs text-gray-400 text-center mt-3",children:"설치 후 홈 화면에서 앱을 실행할 수 있습니다"})]})}),(0,a.jsxs)("main",{className:"flex flex-col items-center max-w-md w-full p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-center mb-6 text-gray-800 dark:text-white",children:"TWA 테스트 애플리케이션"}),(0,a.jsxs)("div",{className:"w-full p-3 mb-4 bg-indigo-50 dark:bg-indigo-900/30 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-sm font-medium mb-2 text-indigo-700 dark:text-indigo-300",children:"버전 정보"}),(0,a.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[(0,a.jsxs)("div",{children:["빌드 시간:"," ",new Date(I).toLocaleString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:"Asia/Seoul"})]}),(0,a.jsxs)("div",{children:["현재 시간: ",f?h:"로딩 중..."]}),(0,a.jsxs)("div",{className:"text-indigo-600 dark:text-indigo-400",children:["버전: ",P]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:["마지막 새로고침:"," ",f?new Date().toLocaleString("ko-KR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"로딩 중..."]})]})]}),(0,a.jsxs)("div",{className:"w-full p-4 mb-6 bg-blue-50 dark:bg-blue-900/30 rounded-lg",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2 text-blue-700 dark:text-blue-300",children:"Trusted Web Activity 정보"}),(0,a.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"이 앱은 PWA 및 TWA 테스트를 위해 설계되었습니다. Android에서 TWA로 설치하여 네이티브 앱처럼 실행할 수 있습니다."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 w-full mb-6",children:[(0,a.jsxs)("div",{className:"p-4 bg-green-50 dark:bg-green-900/30 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-md font-medium mb-2 text-green-700 dark:text-green-300",children:"디바이스 정보"}),(0,a.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",id:"device-info",children:e})]}),(0,a.jsxs)("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/30 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-md font-medium mb-2 text-purple-700 dark:text-purple-300",children:"설치 상태"}),(0,a.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",id:"install-status",children:n})]})]}),(0,a.jsxs)("div",{className:"w-full p-4 mb-6 bg-orange-50 dark:bg-orange-900/30 rounded-lg",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2 text-orange-700 dark:text-orange-300",children:"\uD83D\uDD14 푸시 알림 상태"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["상태: ",(0,a.jsx)("span",{className:"font-medium",children:j})]}),"알림 권한 거부됨"===j&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-red-100 dark:bg-red-900/30 rounded-lg border border-red-200 dark:border-red-800",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-red-700 dark:text-red-300 mb-2",children:"⚠️ 알림 권한이 거부되었습니다"}),(0,a.jsxs)("div",{className:"text-xs text-red-600 dark:text-red-400 space-y-1",children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"Chrome에서 권한 재설정 방법:"})}),(0,a.jsx)("p",{children:"1. 주소창 왼쪽 \uD83D\uDD12 아이콘 클릭"}),(0,a.jsx)("p",{children:'2. "알림" 설정을 "허용"으로 변경'}),(0,a.jsx)("p",{children:"3. 페이지 새로고침 후 다시 시도"})]})]}),v&&(0,a.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:[(0,a.jsx)("p",{className:"mb-1",children:"FCM 토큰:"}),(0,a.jsxs)("p",{className:"break-all bg-gray-100 dark:bg-gray-700 p-2 rounded font-mono",children:[v.substring(0,50),"..."]})]}),(0,a.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:(0,a.jsxs)("p",{children:["브라우저 알림 권한: ",(0,a.jsx)("span",{className:"font-mono",children:C})]})})]})]}),(0,a.jsxs)("div",{className:"w-full flex flex-col gap-3",children:[(0,a.jsx)("button",{className:"w-full py-3 px-4 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white font-medium rounded-lg transition-colors",id:"check-features",onClick:()=>{alert("지원되는 기능:\n"+["Geolocation: ".concat(void 0!==navigator.geolocation?"지원됨":"지원되지 않음"),"Notification: ".concat("Notification"in window?"지원됨":"지원되지 않음"),"Service Worker: ".concat("serviceWorker"in navigator?"지원됨":"지원되지 않음"),"Camera: ".concat(navigator.mediaDevices&&void 0!==navigator.mediaDevices.getUserMedia?"지원됨":"지원되지 않음")].join("\n"))},children:"기능 확인하기"}),(0,a.jsxs)("div",{className:"w-full border-t pt-3 mt-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium mb-3 text-gray-700 dark:text-gray-300",children:"\uD83D\uDD14 푸시 알림 테스트"}),(0,a.jsx)("div",{className:"space-y-2",children:v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:"w-full py-3 px-4 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors",onClick:M,disabled:S,children:S?"발송 중...":"\uD83D\uDCF1 테스트 알림 발송"}),(0,a.jsx)("button",{className:"w-full py-3 px-4 bg-pink-600 hover:bg-pink-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors",onClick:F,disabled:S,children:S?"발송 중...":"\uD83D\uDCE2 전체 알림 발송"})]}):(0,a.jsx)("button",{className:"w-full py-3 px-4 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors",onClick:T,disabled:S,children:S?"처리 중...":"\uD83D\uDD14 알림 권한 요청"})})]}),(0,a.jsx)("button",{className:"w-full py-3 px-4 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors",onClick:()=>{window.location.reload()},children:"\uD83D\uDD04 페이지 새로고침"}),(0,a.jsx)("button",{className:"w-full py-3 px-4 bg-yellow-600 hover:bg-yellow-700 text-white font-medium rounded-lg transition-colors",onClick:()=>{let e={browserPermission:"Notification"in window?Notification.permission:"unknown",statePermission:C,notificationStatus:j,fcmToken:v?"있음":"없음",localStorage:localStorage.getItem("fcm-token")?"있음":"없음"};console.log("권한 상태 디버깅:",e),alert("권한 상태 디버깅:\n".concat(JSON.stringify(e,null,2)))},children:"\uD83D\uDD0D 권한 상태 확인"}),(0,a.jsx)("button",{className:"w-full py-3 px-4 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-lg transition-colors",onClick:async()=>{try{var e,t,n,a,r;let s=await fetch("/api/send-notification",{method:"GET"}),i=await s.json();console.log("API 상태:",i),alert("\uD83D\uDD27 API 상태 확인:\n\n".concat(i.message,"\n\n사용 가능한 엔드포인트:\n- POST: ").concat(null==(e=i.endpoints)?void 0:e.POST,"\n\n필수 파라미터:\n- title: ").concat(null==(n=i.endpoints)||null==(t=n.body)?void 0:t.title,"\n- message: ").concat(null==(r=i.endpoints)||null==(a=r.body)?void 0:a.message,"\n- token 또는 tokens 필요"))}catch(e){console.error("API 상태 확인 오류:",e),alert("❌ API 상태 확인 실패:\n".concat(e instanceof Error?e.message:String(e)))}},children:"\uD83D\uDD27 API 상태 확인"}),(0,a.jsx)("button",{className:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors",onClick:async()=>{try{let t={userAgent:navigator.userAgent,platform:navigator.platform,isAndroid:/Android/i.test(navigator.userAgent),isChrome:/Chrome/i.test(navigator.userAgent),notificationPermission:"Notification"in window?Notification.permission:"not supported",serviceWorkerSupport:"serviceWorker"in navigator,pushManagerSupport:"PushManager"in window,fcmToken:v?"present":"missing",vapidKey:"configured",manifestUrl:"/manifest.json",swUrl:"/sw.js"};if("serviceWorker"in navigator)try{var e;let n=await navigator.serviceWorker.getRegistration();t.swRegistration=n?{scope:n.scope,state:null==(e=n.active)?void 0:e.state,onupdatefound:n.onupdatefound?"present":"none"}:"not registered"}catch(e){t.swRegistration="error: ".concat(e instanceof Error?e.message:String(e))}if("serviceWorker"in navigator&&"PushManager"in window)try{let e=await navigator.serviceWorker.getRegistration();e&&(t.pushSubscription=await e.pushManager.getSubscription()?"active":"none")}catch(e){t.pushSubscription="error: ".concat(e instanceof Error?e.message:String(e))}console.log("Android 푸시 알림 디버깅:",t);let n=Object.entries(t).map(e=>{let[t,n]=e;return"".concat(t,": ").concat("object"==typeof n?JSON.stringify(n):n)}).join("\n");alert("\uD83E\uDD16 Android 푸시 알림 디버깅 정보:\n\n".concat(n))}catch(e){console.error("디버깅 정보 수집 오류:",e),alert("❌ 디버깅 정보 수집 실패:\n".concat(e instanceof Error?e.message:String(e)))}},children:"\uD83E\uDD16 Android 디버깅 정보"})]}),(0,a.jsxs)("div",{className:"w-full mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-sm font-medium mb-2 text-gray-700 dark:text-gray-300",children:"PWA 설치 디버깅 정보"}),(0,a.jsx)("pre",{className:"text-xs text-gray-600 dark:text-gray-400 whitespace-pre-wrap",children:g})]})]}),(0,a.jsx)("footer",{className:"mt-8 text-center text-xs text-gray-500 dark:text-gray-400",children:(0,a.jsx)("p",{children:"\xa9 2024 TWA 테스트 애플리케이션"})})]})}},5277:(e,t,n)=>{Promise.resolve().then(n.bind(n,24))},6104:(e,t,n)=>{"use strict";n.d(t,{JK:()=>m,d7:()=>g,mT:()=>d});var a=n(3915),r=n(996),s=n(6267);let i={apiKey:"AIzaSyDbsQpQVwLB0bNSPWmHI_FL4zMCzasOAzI",authDomain:"my-pwa-mobile-app.firebaseapp.com",projectId:"my-pwa-mobile-app",storageBucket:"y-pwa-mobile-app.firebasestorage.app",messagingSenderId:"71708096970",appId:"1:71708096970:web:e482700e892498d717b733"};console.log("Firebase 설정 상태:",{apiKey:i.apiKey?"설정됨":"누락",authDomain:i.authDomain?"설정됨":"누락",projectId:i.projectId?"설정됨":"누락",storageBucket:i.storageBucket?"설정됨":"누락",messagingSenderId:i.messagingSenderId?"설정됨":"누락",appId:i.appId?"설정됨":"누락",vapidKey:"설정됨"});let o=[];i.apiKey||o.push("NEXT_PUBLIC_FIREBASE_API_KEY"),i.authDomain||o.push("NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN"),i.projectId||o.push("NEXT_PUBLIC_FIREBASE_PROJECT_ID"),i.messagingSenderId||o.push("NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID"),i.appId||o.push("NEXT_PUBLIC_FIREBASE_APP_ID"),o.length>0&&console.error("누락된 Firebase 환경 변수:",o);let l=(0,a.Wp)(i),c=null;c=(0,r.dG)(l);let d=async()=>{if(!c)return console.error("Firebase messaging이 초기화되지 않았습니다."),{success:!1,error:"Firebase messaging not initialized",permission:null,token:null};try{let e=await Notification.requestPermission();if(console.log("알림 권한 요청 결과:",e),"granted"===e){try{let e=await navigator.serviceWorker.getRegistration();e?console.log("기존 서비스 워커 사용:",e.scope):console.warn("서비스 워커가 등록되지 않았습니다.")}catch(e){console.warn("서비스 워커 확인 실패:",e)}try{let t=await navigator.serviceWorker.getRegistration(),n=await (0,r.gf)(c,{vapidKey:"BGnEl9hdw4-f4ntPX3xb-d1HfzcufgzmUPFv7O4WvMnxIO6f48ztbYPETXOvsC--aP9-EIqKG6hoZpEHSKmjHdw",serviceWorkerRegistration:t||void 0});if(n)return console.log("FCM Token 생성 성공:",n),{success:!0,permission:e,token:n,error:null};return console.error("FCM 토큰 생성 실패: 토큰이 null입니다."),{success:!1,permission:e,token:null,error:"FCM token generation failed"}}catch(t){return console.error("FCM 토큰 생성 중 오류:",t),{success:!1,permission:e,token:null,error:"FCM token error: ".concat(t)}}}if("denied"===e)return console.log("사용자가 알림 권한을 거부했습니다."),{success:!1,permission:e,token:null,error:"Permission denied by user"};return console.log("알림 권한이 기본값(default)입니다."),{success:!1,permission:e,token:null,error:"Permission is default"}}catch(e){return console.error("알림 권한 요청 중 오류:",e),{success:!1,permission:null,token:null,error:"Permission request failed: ".concat(e)}}},g=()=>new Promise(e=>{c&&(0,r.xD)(c,t=>{console.log("포그라운드 메시지 수신:",t),e(t)})}),m=()=>s.Ii.isNativePlatform()}},e=>{var t=t=>e(e.s=t);e.O(0,[568,441,684,358],()=>t(5277)),_N_E=e.O()}]);